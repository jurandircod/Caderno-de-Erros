[build]
builder = "nixpacks"
buildCommand = """
  composer install --no-dev --optimize-autoloader
  chmod -R 775 storage bootstrap/cache
  mkdir -p database
  touch database/database.sqlite
"""

[deploy]
startCommand = "php -S 0.0.0.0:$PORT -t public"
postDeployCommand = """
  php artisan key:generate
  php artisan config:cache
  php artisan route:cache
  php artisan view:cache
  php artisan migrate --force
"""

[env]
APP_NAME = "Caderno de Erros"
APP_ENV = "production"
APP_KEY = ""  # Ser√° gerada pelo build
APP_DEBUG = "false"
APP_URL = "https://caderno-de-erros-production.up.railway.app"
DB_CONNECTION = "sqlite"
DB_DATABASE = "database/database.sqlite"
DB_FOREIGN_KEYS = "true"
